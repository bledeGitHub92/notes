## 基本类型和引用类型的值

ECMAScript 变量可能包含两种不同数据类型的值：基本类型值和引用类型值。基本类型值指的是简单的数据段。引用类型值指那些可能由多个值构成的对象。

基本类型值保存在栈内存中。引用类型值保存在堆内存中。

### 复制变量值

复制基本类型值时，创建一个新值。之后的任何操作互不影响。

复制引用类型值时，实际上复制的是该引用类型的指针。两个变量指向对一个对象。改变一个变量会影响另一个变量。

### 传递参数

ECMAScript 中所有函数的参数都是按值传递的。也就是说，把函数外部的值传递给函数内部的参数，就和把值从一个变量复制到另外一个变量一样。

> 如果函数的参数是按引用传递的，那么 person 会指向新对象。

    function setName(obj) {
        obj.name = 'joe';
        obj = new Object();
        obj.name = 'rose';
    }

    var person = new Object();
    setName(person);
    alert(person.name);  // joe

### 检测类型

instanceof 操作符检测变量是什么类型的对象。

    result = variable instanceof constructor

## 执行环境及作用域 / P

### 函数创建

函数创建时，会创建一个包含变量对象的作用域链并保存在内部的 [[Scope]] 属性中。

### 函数执行

函数执行时，通过函数的 [[Scope]] 属性构建起执行环境的作用域链，此后创建当前执行环境的活动并推入执行环境作用域链的前端。

### 执行环境

全局执行环境 / 函数执行环境。

执行环境定义了变量或函数有权访问的其他数据。

执行环境中的所有代码执完毕后，该环境被销毁，保存在其中的所有变量和函数定义也随之销毁（全局执行环境知道应用程序退出——例如关闭网页时才销毁）。

### 变量对象

每个执行环境都有一个与之关联的变量对象。

执行环境中定义的所有变量和函数都保存在这个对象中。

### 作用域链

作用域链是一个指向变量对象的指针列表，只引用但不包含实际的变量对象。

作用域链是保证对执行环境有权访问的所有变量和函数的有序访问。

作用域链的前端始终是当前执行的代码所在的环境的变量对象。作用域链中的下一个变量对象来自其包含环境，全局执行环境的变量对象始终是作用域链中的最后一个对象。

### 标识符解析

标识符解析是从作用域链前端一级一级地向后搜索标识符的过程。

### 延长作用域链

有些语句可以在作用域链的前端临时增加一个变量对象，在代码执行之后被移除。

执行流进入下列任意一个语句时，会在作用域链的前端临时增加一个变量对象：

- try-catch 语句的 catch 块。
- with 语句。

对 with 语句来说，会将指定的对象添加到作用域链中。对 catch 语句来说，会创建一个新的变量对象，其中包含的是被抛出的错误对象的声明。

### 声明变量

使用 var 声明的变量会自动添加到最近的环境中。

## 垃圾搜集

js 具有自动垃圾回收机制，执行环境会负责管理代码执行过程中使用的内存。